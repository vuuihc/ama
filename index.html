<!DOCTYPE html>
<html>
  <head>
    <script type="text/javascript" src="./libs/flexible.js"></script>
    <script type="text/javascript" src="./libs/vconsole.min.js"></script>
    <script src="./libs/zepto.min.js" ></script>
    <script src="./libs/jr-qrcode.min.js" ></script>
    <script type="text/javascript" src="http://res.wx.qq.com/open/js/jweixin-1.0.0.js"></script>
    <title>七点一刻</title>
  </head>
  <body>
    <div id="root">
    </div>
    <script>
      var wx_config = {};//全局变量
      function getWxConfig(){
        fetch('http://api.7dyk.com/api/v1/question/test')
            .then(function(response){ return response.json()})
            .then(function(json){
              var data = json.data;
              var jsApiList = [
                  'startRecord',
                  'stopRecord',
                  'onVoiceRecordEnd',
                  'playVoice',
                  'pauseVoice',
                  'stopVoice',
                  'onVoicePlayEnd',
                  'uploadVoice',
                  'downloadVoice'
              ]
//              wx_config['url'] = "http://h5app.7dyk.com/ama/7dyk/";
              wx_config['debug'] = true;
              wx_config['url'] = "http://localhost:8080/";
              wx_config['appId'] = data['appId'];
              wx_config['timestamp'] = data['timestamp'];
              wx_config['nonceStr'] = data['nonceStr'];
              wx_config['signature'] = data['signature'];
              wx_config['jsApiList'] = jsApiList;
              console.log(wx_config);
              wx.config(wx_config);
            })
      }
      window.onload = function () {
//        wx.config({
//          debug: true, // 开启调试模式,调用的所有api的返回值会在客户端alert出来，若要查看传入的参数，可以在pc端打开，参数信息会通过log打出，仅在pc端时才会打印。
//          appId: 'wxfbe89421611bdb2d', // 必填，公众号的唯一标识
//          timestamp: , // 必填，生成签名的时间戳
//          nonceStr: '', // 必填，生成签名的随机串
//          signature: '',// 必填，签名，见附录1
//          jsApiList: [] // 必填，需要使用的JS接口列表，所有JS接口列表见附录2
//        })
        getWxConfig();
        wx.ready(function(){
          alert('wxapi is ready')
          console.log('wxapi is ready')
        })
        wx.error(function (res) {
          alert("error is "+res)
          console.log("error is "+res)
        })
      }
    </script>
    <!--<script src="./dist/mobile.js"></script>-->
    <script src="http://localhost:8080/assets/mobile.js"></script>
  </body>
</html>
