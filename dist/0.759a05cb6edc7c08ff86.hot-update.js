webpackHotUpdate(0,{97:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function i(e){return{tutorInfo:e.tutorInfo,tutorAnswerList:e.tutorAnswerList,prepayInfo:e.prepayInfo}}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),c=n(1),l=a(c),d=n(6),f=n(7),m=n(27),p=n(12),h=n(66),v=a(h),y=n(16),E=a(y),g=n(21),b=a(g),k=n(5);n(169);var w=function(e){function t(e){r(this,t);var n=o(this,Object.getPrototypeOf(t).call(this,e));return n.state={curPage:1,askSuccess:!1,loading:!1},n.routerWillLeave=n.routerWillLeave.bind(n),n}return s(t,e),u(t,[{key:"payForAsk",value:function(e,t){var n=this,a=k.domain+("/api/v1/question/testquestion?content="+e+"&answer_user_id="+t);this.setState({loading:!0}),fetch(a,{credentials:"same-origin"}).then(function(e){return e.json()}).then(function(e){n.setState({loading:!1});var t=n;void 0!=e.data.timeStamp&&!function(){var n=function a(){WeixinJSBridge.invoke("getBrandWCPayRequest",e.data,function(e){if("get_brand_wcpay_request:ok"==e.err_msg){console.log("支付成功！"),t.setState({askSuccess:!0}),t.props.dispatch((0,p.getIAsked)(1,10));var n=setTimeout(function(){d.browserHistory.push(k.baseUrl+"account/IAskedList")},2e3);t.setState({successTimer:n})}else console.log(e),alert("支付失败");document.removeEventListener?document.removeEventListener("WeixinJSBridgeReady",a):document.attachEvent&&(document.detachEvent("WeixinJSBridgeReady",a),document.detachEvent("onWeixinJSBridgeReady",a))})};"undefined"==typeof WeixinJSBridge?document.addEventListener?document.addEventListener("WeixinJSBridgeReady",n,!1):document.attachEvent&&(document.attachEvent("WeixinJSBridgeReady",n),document.attachEvent("onWeixinJSBridgeReady",n)):n()}()})}},{key:"askBtnClick",value:function(){var e=this.refs.content.value;if(console.log("content is ==="+e),""==e)return void alert("内容不能为空哦");var t=this.props.params.id;this.props.dispatch((0,m.getPrepayInfo)(e,t)),this.payForAsk(e,t)}},{key:"componentDidMount",value:function(){function e(e){if(window.scrollY+window.innerHeight==document.body.clientHeight&&!this.props.tutorAnswerList.completed){var n=++this.state.curPage;this.setState({curPage:n}),this.props.dispatch((0,m.getTutorAnswerList)(t,n,10))}}var t=this.props.params.id;this.props.dispatch((0,m.getTutorInfo)(t)),this.props.dispatch((0,m.getTutorAnswerList)(t,1,10)),this.props.router.setRouteLeaveHook(this.props.route,this.routerWillLeave),document.addEventListener("scroll",e.bind(this))}},{key:"routerWillLeave",value:function(e){if(""!=this.refs.content.value&&!this.state.askSuccess)return"您的提问尚未支付，确认离开?"}},{key:"componentWillUnmount",value:function(){clearTimeout(this.state.successTimer)}},{key:"render",value:function(){var e=this.props,t=e.tutorInfo,a=e.tutorAnswerList;return l["default"].createElement("main",{className:"tutorIndex"},l["default"].createElement(b["default"],{show:this.state.askSuccess},"提问成功"),l["default"].createElement(b["default"],{icon:"loading",show:this.state.loading},"请求支付中……"),l["default"].createElement("div",{className:"tutor-info"},l["default"].createElement(d.Link,{to:k.baseUrl+("tutor/share/"+t.user_id)},l["default"].createElement("img",{className:"QREntry",src:n(82)})),l["default"].createElement("img",{className:"avatar",src:t.user_face}),l["default"].createElement("h3",{className:"tutor-name"},t.user_name),l["default"].createElement("h4",{className:"tutor-title"},t.user_title),l["default"].createElement("h5",{className:"tutor-intro"},t.user_introduction),l["default"].createElement("div",{className:"grade"},l["default"].createElement("div",{className:"num"},l["default"].createElement("span",null,"￥",t.teacher_income),l["default"].createElement("span",null,"￥",t.listen_num)),l["default"].createElement("div",{className:"grade-name"},l["default"].createElement("span",null,"总收入"),l["default"].createElement("span",null,"被偷听"))),l["default"].createElement("textarea",{ref:"content",placeholder:"向"+t.user_name+"提问，等TA语音回答；超过24小时未回答，将按支付路径全额退款"}),l["default"].createElement("div",{className:"value"},"￥",t.teacher_prize),l["default"].createElement("a",{className:"bottom-btn",onClick:this.askBtnClick.bind(this)},"向TA提问")),l["default"].createElement("div",{className:"question-list"},l["default"].createElement("h5",{className:"title"},"他还回答了这些问题"),a.data.map(function(e,n){return l["default"].createElement(v["default"],{head:t.user_face,key:n,question:e})}),l["default"].createElement(E["default"],{completed:a.completed})))}}]),t}(c.Component);w=(0,d.withRouter)(w),w.propTypes={tutorInfo:c.PropTypes.shape({}).isRequired},w.contextTypes={router:c.PropTypes.object},t["default"]=(0,f.connect)(i)(w)}});
//# sourceMappingURL=0.759a05cb6edc7c08ff86.hot-update.js.map