{"version":3,"sources":["webpack:///./src/javascripts/containers/blocks/QuestionItemWithAvatar.js?6c9f"],"names":[],"mappings":"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","file":"0.ddfb56cb1e365cc95eec.hot-update.js","sourcesContent":["import React, {Component} from 'react'\r\nimport { Link } from 'react-router'\r\nimport {baseUrl} from \"../../api/config\"\r\n\r\nclass QuestionItemWithAvatar extends Component{\r\n    constructor(){\r\n        super();\r\n        this.state={\r\n            curQuestionId:null,\r\n            curAnswerId:null\r\n        }\r\n    }\r\n    getPrepayInfo(questionId,answerId){\r\n        this.setState({curQuestionId:questionId,curAnswerId:answerId})\r\n        this.props.dispatch(getListenInfo(answerId))\r\n    }\r\n    bubbleClick(answerId,questionId,isPayed){\r\n        if(isPayed){\r\n            browserHistory.push(`${baseUrl}question/${questionId}`)\r\n        }else{\r\n            this.getPrepayInfo(questionId,answerId)\r\n        }\r\n    }\r\n    componentWillReceiveProps(nextProps){\r\n        const self = this\r\n        console.log(nextProps.listenInfo.data)\r\n        if(nextProps.listenInfo.data.timeStamp!=undefined){\r\n            const time = new Date()\r\n            if(time.valueOf()/1000-nextProps.listenInfo.data.timeStamp<5){\r\n                console.log(\"进入微信支付\")\r\n                function onBridgeReady(){\r\n                    WeixinJSBridge.invoke(\r\n                        'getBrandWCPayRequest', nextProps.listenInfo.data,\r\n                        function(res){\r\n                            if(res.err_msg == \"get_brand_wcpay_request:ok\" ) {\r\n                                console.log(\"支付成功！\")\r\n                                browserHistory.push(`/question/${self.state.curQuestionId}`)\r\n                            }else{\r\n                                alert(\"支付失败，原因：\"+JSON.stringify(res))\r\n                            }\r\n                            if( document.removeEventListener ){\r\n                                document.removeEventListener('WeixinJSBridgeReady', onBridgeReady);\r\n                            }else if (document.attachEvent){\r\n                                document.detachEvent('WeixinJSBridgeReady', onBridgeReady);\r\n                                document.detachEvent('onWeixinJSBridgeReady', onBridgeReady);\r\n                            }\r\n                            // 使用以上方式判断前端返回,微信团队郑重提示：res.err_msg将在用户支付成功后返回    ok，但并不保证它绝对可靠。\r\n                        }\r\n                    );\r\n                }\r\n                if (typeof WeixinJSBridge == \"undefined\"){\r\n                    if( document.addEventListener ){\r\n                        document.addEventListener('WeixinJSBridgeReady', onBridgeReady, false);\r\n                    }else if (document.attachEvent){\r\n                        document.attachEvent('WeixinJSBridgeReady', onBridgeReady);\r\n                        document.attachEvent('onWeixinJSBridgeReady', onBridgeReady);\r\n                    }\r\n                }else{\r\n                    onBridgeReady();\r\n                }\r\n                // wx.chooseWXPay({\r\n                //   timestamp:nextProps.listenInfo.data.timeStamp, // 支付签名时间戳，注意微信jssdk中的所有使用timestamp字段均为小写。但最新版的支付后台生成签名使用的timeStamp字段名需大写其中的S字符\r\n                //   nonceStr: nextProps.listenInfo.data.nonceStr, // 支付签名随机串，不长于 32 位\r\n                //   package: nextProps.listenInfo.data.package, // 统一支付接口返回的prepay_id参数值，提交格式如：prepay_id=***）\r\n                //   signType: nextProps.listenInfo.data.signType, // 签名方式，默认为'SHA1'，使用新版支付需传入'MD5'\r\n                //   paySign: nextProps.listenInfo.data.paySign, // 支付签名\r\n                //   success: function (res) {\r\n                //     console.log(\"支付成功！\");\r\n                //     browserHistory.push(`/question/${self.state.curQuestionId}`)\r\n                //     // self.props.dispatch(getListenInfo(self.state.curQuestionId))\r\n                //   },\r\n                //   fail:function(res){\r\n                //     alert(\"支付失败\")\r\n                //     console.log(\"失败原因：\")\r\n                //     console.log(res)\r\n                //   }\r\n                // });\r\n            }else if(nextProps.listenInfo.data.url!=undefined){\r\n                // this.context.router.push(`question/${self.state.curQuestionId}`)\r\n            }\r\n        }\r\n    }\r\n    render() {\r\n        const { question } = this.props;\r\n        return(\r\n            <article>\r\n                <Link to={baseUrl +\"question/\"+question.question_id}>\r\n                    <div className=\"question-content\">\r\n                        <h4>{question.question_content}</h4>\r\n                    </div>\r\n                </Link>\r\n                <Link to={baseUrl+\"tutor/\"+question.teacher_id}>\r\n                    <div className=\"mentor\">\r\n                        <img src={question.teacher_face}/>\r\n                        <div className=\"mentor-info\">\r\n                            <span className=\"name\">{question.teacher_name}</span>\r\n                            <span>{question.user_title}</span>\r\n                        </div>\r\n                    </div>\r\n                </Link>\r\n                <div className=\"answer\" >\r\n                <span className=\"bubble\" onClick={this.bubbleClick.bind(this,question.answer_id,question.question_id,question.answer_ispayed)}>\r\n                  <span className=\"bubble-tail\"></span>\r\n                  <span className=\"bubble-voice\"></span>\r\n                  <span className=\"bubble-text\">{question.answer_ispayed?\"点击偷偷听\":\"1元偷偷听\"}</span>\r\n                </span>\r\n                </div>\r\n                <div className=\"remark\">\r\n                    <div className=\"value\">价值￥{question.question_prize}</div>\r\n                    <div className=\"remark-info\">\r\n                        <span>{question.answer_listen}人偷听</span>\r\n                        <span className=\"kui\">{question.answer_like}人觉得赞</span>\r\n                    </div>\r\n                </div>\r\n            </article>\r\n        )\r\n    }\r\n}\r\nexport default QuestionItemWithAvatar;\n\n\n/** WEBPACK FOOTER **\n ** ./src/javascripts/containers/blocks/QuestionItemWithAvatar.js\n **/"],"sourceRoot":""}